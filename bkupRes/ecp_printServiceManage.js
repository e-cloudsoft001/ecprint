window,window.printService={init:function(e,t,n,i){var s,l;function r(e){for(var t=document.querySelectorAll("table > tbody > tr"),n=0;n<t.length;n++){var i=t[n];""==i.id&&i.parentNode.removeChild(i)}if("true"==e)for(n=0;n<printerList.length;n++){document.getElementById("grid_1").style.display="",(o=(a=document.getElementById("tr1_id")).cloneNode(!0)).id="",o.style.display="";var s=(c=printerList[n]).aliasName,l=c.ipAddress,r=c.machineId,d=c.macAddress;o.cells[0].textContent=s,o.cells[1].textContent=l,o.cells[2].textContent=r,o.cells[3].textContent=d,a.parentNode.insertBefore(o,a)}else for(var a,o,n=0;n<printerList.length;n++){document.getElementById("grid_2").style.display="",(o=(a=document.getElementById("tr2_id")).cloneNode(!0)).id="",o.style.display="";var c,s=(c=printerList[n]).aliasName,l=c.ipAddress,r=c.machineId,d=c.macAddress,m=c.connectedFlg;o.cells[0].textContent=s,o.cells[1].textContent=l,o.cells[2].textContent=r,o.cells[3].textContent=d,o.cells[4].textContent=m,a.parentNode.insertBefore(o,a)}}function d(n,t){if(t)printerList=[],Object.keys(n).forEach(e=>{e=n[e];let t="";t=e.aliasName||e.mac;e={aliasName:e.aliasName,ipAddress:e.ip,macAddress:e.mac,machineId:e.machineId,text:t};printerList.push(e)});else{let e="";e=n.aliasName||n.mac;t={aliasName:n.aliasName,ipAddress:n.ip,macAddress:n.mac,machineId:n.machineId,connectedFlg:"稼動中",text:e};(printerList=[]).push(t)}}printerList=[],0<t.length?(t=t,s=n,n=i,(i=e)&&"true"==s?((l=io(t,{auth:{token:i}})).emit("getCurrentClients",{auth:{token:i}}),l.on("currentClients",e=>{d(e,!0),r(s)})):(l=io(t),i={ipAddress:n,connectedFlg:"未接続"},printerList.push(i),r(s),l.on("clientInfo",e=>{console.log(e),d(e,!1),r(s)}))):r()},downloadCer:function(e){window.open(e)}};
